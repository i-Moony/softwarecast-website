---
interface Comment {
    author: {
        name: string;
        link: string;
    };
    content: string;
    respond?: Comment;
}

interface Props {
    comment: Comment;
    respond?: boolean;
}

function formatMultiline(text: string) {
    const multiline = text.trim().replaceAll("\n", "<br>");

    return multiline;
}

const { comment, respond = false } = Astro.props;
---

<div
    class={respond
        ? "flex flex-col gap-0.5 mt-2 xss:ml-4 lg:ml-8 pl-4 border-l border-brand-black/50"
        : "flex flex-col gap-0.5"}
>
    {
        comment.author ? (
            <p class="font-bold">
                &gt; Автор:
                <a
                    href={comment.author.link}
                    target="_blank"
                    class="underline w-fit"
                >
                    {comment.author.name}
                </a>
            </p>
        ) : (
            <div class="flex flex-row items-center gap-1.5 font-bold">
                <p>&gt; СофтварьКаст</p>
            </div>
        )
    }
    <p set:html={formatMultiline(comment.content)} />
    {
        comment.respond ? (
            <Astro.self comment={comment.respond} respond={true} />
        ) : (
            ""
        )
    }
</div>
